<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Custom visualiser example (ES5 version) | Akko Music Visualising Framework</title>

        <!-- Make the page look a bit nicer (this does not affect Akko) -->
        <link rel="stylesheet" href="/mixer/css/prettify.css"/>

        <!-- Akko CSS -->
        <link rel="stylesheet" href="/mixer/dist/akko.min.css"/>

        <!-- Modern Mixer Styling -->
        <link rel="stylesheet" href="/mixer/css/style.css"/>

    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>MuizenMixer</h1>
                <p>Experience music through stunning 3D visualizations. Drop your tracks into our browser-based Akko visualizer and watch your audio come to life with interactive, real-time graphics.</p>
            </div>

            <div class="visualizer-container">
                <div id="akko"></div>
                <button id="playButton" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); padding: 15px 30px; font-size: 1.5rem; background-color: #4CAF50; color: white; border: none; border-radius: 10px; cursor: pointer; z-index: 100;">Play Mixer</button>
            </div>

            <div class="feature-highlight">
                <p><strong>Interactive Experience:</strong> Hover over the visualization to grab particles, click to add more, and watch as your music transforms into beautiful 3D art.</p>
            </div>

            <div class="controls-info">
                <div class="info-card">
                    <h3>üéµ How to Use</h3>
                    <ul>
                        <li>Click play to start the demo tracks</li>
                        <li>Drag and drop your own audio files</li>
                        <li>Hover over the visualization to interact</li>
                        <li>Click to add more visual elements</li>
                        <li>Enjoy the real-time audio-reactive graphics</li>
                    </ul>
                </div>
                
                <div class="info-card">
                    <h3>üé® Visual Modes</h3>
                    <ul>
                        <li><strong>Cubes:</strong> 3D frequency-reactive cubes</li>
                        <li><strong>Wave:</strong> Animated wireframe terrain</li>
                        <li><strong>Sphere:</strong> Particle sphere visualization</li>
                        <li><strong>Bars:</strong> Classic frequency bars</li>
                        <li>Switch between modes using controls</li>
                    </ul>
                </div>
            </div>

            <div class="feature-highlight">
                <p>üöÄ <strong>Coming Soon:</strong> Upload and share your remixes with the community under our collaborative culture contract!</p>
            </div>
        </div>

        <!-- Akko's dependencies -->
        <script src="https://cdn.jsdelivr.net/bluebird/latest/bluebird.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/86/three.min.js"></script>

        <!-- Debug dependencies -->
        <script>
            console.log('Dependencies loaded:');
            console.log('- Promise/Bluebird:', typeof Promise);
            console.log('- THREE.js:', typeof THREE);
        </script>

        <!-- Load Akko with proper error handling -->
        <script>
            // Clear any existing module system
            delete window.module;
            delete window.exports;
            delete window.require;
        </script>
        <script src="/mixer/dist/akko.min.js" onerror="console.error('Failed to load akko.min.js')"></script>
        <script>
            console.log('After akko.min.js - Akko:', typeof Akko);
            console.log('Window keys containing akko:', Object.keys(window).filter(k => k.toLowerCase().includes('akko')));
            
            // Check if it's in a different location
            if (typeof Akko === 'undefined') {
                console.log('Checking window object for Akko...');
                for (let key in window) {
                    if (key.toLowerCase().includes('akko') || (typeof window[key] === 'function' && window[key].toString().includes('Akko'))) {
                        console.log('Found potential Akko at window.' + key + ':', typeof window[key]);
                    }
                }
            }
        </script>

        <!-- Debug Akko loading -->
        <script>
            console.log('Akko loaded:', typeof Akko);
            if (typeof Akko === 'undefined') {
                console.error('‚ùå Akko failed to load!');
                alert('Akko framework failed to load. Check console for errors.');
            }
        </script>

        <!-- Defining our visualiser and starting Akko -->
        <script src="/mixer/js/components/CustomVisualiser.js"></script>
        <script src="/mixer/js/components/WaveVisualiser.js"></script>
        <script src="/mixer/js/components/SphereVisualiser.js"></script>
        <script src="/mixer/js/components/CustomBarsVisualiser.js"></script>
        <script src="/mixer/js/components/BarVisualiser.js"></script>
        <script src="/mixer/js/components/RingVisualiser.js"></script>
        <script src="/mixer/js/main.js"></script>

    </body>
</html>
